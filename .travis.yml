sudo: required
dist: trusty
language: node_js
node_js:
- '6.10'
services:
- docker
before_install:
- export CHROME_BIN=chromium-browser
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- sudo apt-get update
- sudo apt-get install -y libappindicator1 fonts-liberation
- wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
- sudo dpkg -i google-chrome*.deb
- sudo apt-get install -y sshpass
before_script:
- npm install -g @angular/cli
script:
- ng build --prod
after_success:
- if [ $TRAVIS_PULL_REQUEST == "false" ]; then
  docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS;
  export REPO=noefc/client;
  export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`;
  docker build -f Dockerfile -t $REPO:$COMMIT .;
  docker tag $REPO:$COMMIT $REPO:$TAG;
  docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER;
  docker push $REPO; export SSHPASS=$DEPLOY_PASS;
  sshpass -e ssh $DEPLOY_USER@$DEPLOY_HOST $DEPLOY_PATH/deploy.sh
  fi
env:
  global:
  - secure: UzfqV/3l2VbJyyJsvMN4yj0rmWBx/JIT0h2x/5Qssg0RtqBJPNGDhIl97eUGi3daOWkgknSQ/apqUJleLysUfutr1sgM4DWEn+CkELxHzD5RFMVAsuULxuCAzgmWC5Kumc94UGgY/yBBHg9AdPllASyM6gZkJvWA/ONk0meRTldd9w5U3H+e2cmDEgiPZeqWTkJbgMto8BhtZncqm2dp0qYs/BSZJ9IIRqVrQ1IJxhBq6YQSMlD5ZU1p6dL8O9+rc/VYJmvOP/hvWcw1GlMmFNS4078+CH7vCX32Fok5siqgag0UbiTO7QkIn64/kMhKaTv47cU5kyMux3HMRqyjpTI5umSLH+0MtbGxUqaz5ZENd1rG31zGP/4pcbyXFFR79hcR6N58cCscfLHL0CtB9PEFRiWB0DS1bLOi6OXdGnub735B3nroJ8Q51W+OW/vQWGoL5cKKO7YsorgQ+BRDIuup5wogbjbyttTQ2QkZ/2JurK7Rmm07Adc4/27OjDbTiOQEEiR7wVHEitrXAefAUBjtumjDev4BaKqfNsG5Pep6b+4aXZ5nH0gY0ayTF0HlqkLAWEDTfSU7Cm8UJp8JIXpMS+s62m27vKTHmuFIv9qDH+7nvbi5S9zRqFgAAkeYZc0GdvoWok+CmjJ+dF7J048nc2SsSa0fxRwtd6pTeCQ= #DOCKER_EMAIL
  - secure: ez/PuK7oMqryd3g7BEPd32uGwEKtICi39HDPCCMPCyLZeWw6iux1JX3kA7BdqXirypC6mK1zX/ln5dzRV/Uon/DXJmjNCFlMj9HmIrQLKsETTAQ8+o6KWJkSZE/Qtz6c8PIDdS51+OR8rfoUjTRdDrUFToqPPlJWxvHRIEZxUUuhp6KZLzyLN1/ReP+6MSlSFrhHDoCdrm96m6eU2FtOkn/Hpo/BfBm5PKjtGcp3ZhVIhBTFzWEPH7+TrhnsNs1LEAFV3ADV9VFLSLNcUYb1zDGYzWIw2biu3DiqMqe5rgIkm4TjXULrp6XXWb20f1GNoHRZ4kxeaw4VdisiiGBuq0MqdUqiJnDdoscLw4bWNDRaE1hYy3Qc+WwDwou0Ua0RUl33r3c52r7sJYgpXVrXNs+fz/j6DVqvB1DVu0kyKTSfC8kliTkO5boPZyTXKTpv05eSkgIVqiUiNYY4xdd1SdmkzLGIn6K6qhYule1WcEK5ho4Dc9ZnMUzTmmCGLKkctqkjBmS69aZ8tcbSXF6U4HinbEFbp8Hs1MseWQdUcUD60+GBPxKIXrb74t0/f5FNHAK6CMZn0YbfDl89m3P6DH6tfpK1XHh/UB2AxEgl9KsfH0sdOi9maCpy+HWLjN/q+u8tW66EpZHWe3dPu4r8ebxQCaDFGoAaaZuoQXwVK50= #DOCKER_USER
  - secure: AvGQ4cQ9/nqQAaOW2H5Hg4yiZnAZbBqaXEqDKtooU3eul6ZYCQFcGqVsqNeCrrqTes1X36oWlPq08XBXbSG1HiUP9VMiS2ShYtkvUpt66XKKFGrGYvSYq7B1/3rZIGEzmzGP+jFOI2qYZGvVGHjRKV0AY6J/rYcngzgkzal2awHpaO+tSXvNKTMz8WKbWWMzVJiiDr0wJJvtW58YB6fKMstJktehq+IzpQS85Fb6OkGpDZnOngTkVuyo1NPgH9GP7M7a8VNE664uoSnGKYcu0PbbGbELruDAEEfedkpc8bpF0Jv71yvAz4evzfHjbe4jgsqQZv2qZoDPGrcxgA6h3GG3QzW+rIhFz5UNdyBWwWqaX/kag0nmiBj8Zg/EHn/prl2d///zl7DQ3QdQEliYPorSnGNARS51Gp4jifm9F6p1XVK3eilSO+huUcLOE7giSrPWBJQ+PEE4qyWbUPHHSvl9neahWyEWcvq6Q/sgkIdjlNbd2Xg53IJCpZHHPk6IYVxsGnCF7r0X49YaJFGuA1oFNNB1RQFJmGqsYmbxQRiDt/y0e9YVOCsbl9ZzW77Bvh1PS+iMFLeBvtgu5+w0mFZ9R3N9X2IvZSVhpyL/D2ogrRGSHKKQKQLxEHeKMTj+tve4cHFk1XGa11MchHYEMBos7aySm6Bemay78tNbsdQ= #DOCKER_PASS
  - COMMIT=${TRAVIS_COMMIT::8}
  - secure: IyzS+4fVe8qRwPkxCe6axe7LLAp19P1Ld6qF6x2QGoh5nT17EK7zQDwlqiSCmy3lPz1/KE0xMnvf3baB9o5OM31exT6rlrdnJ6jZcXOtGzRHe+J4mIrfF9isF82BfdvVwOovQmBJ3oVOqKXeHeuRx2FvdfytQkv1w2XWGtfJbtltEx0gPOqclwHbKgS/i1NjWUQ1XG2OVUTUwldoiZsVagMbspVahcHRpnJO6xngNHSpy+5eAAiLmkwo2uJ7LnjxXWyQwKJy7Sy4DvEJLfcjx1LoPlM2Z59X8BZiFbywXmhUn1us//klQshjK6ek0OOlo1h1LYMtBwH2LyfXLRY8q0MbAnMlOawShgVNbo1V9rvPpFCMpA4RkxAII7CpMOSW1KT8EG1JrO/rTor8yNuQASIA9ChupHsO+SqL2Yfo/Qqymh9K7z7dlu1leCBdrg3irrBwU0u4B+PSBb2GuX0uYNYFu3SCuj2ZdL1YS4nVN3JFYuDKJN0sBMAqtfW6NCC72XflhkdWz2Nt5yoPGSZhtxQpUSkKT1VQZuXFuKuOTVkcGhSa1uIV30+tS/GXGzfkDUUm1ureIHOXw26W1vtitMljKyFP0cNPU4p11QFRAfO5cZg11M+KFX1l20TmxZZeaIy2hFy0tV4DiOxrEwLOxhiAp394GIBkZRXAaPDVE3c=
  - secure: xNyzQOnA8PT6U0SYGMsDSgiapTdyQvDnV14zqB9KmiF2SJ3dg4dToJQlhYjCKSeBf7eSvpDq88duSvJQt7IzFhLk3KbohwDN/BRxLRvIlQL1L5f8FbKLlsEEeXBvVM7SZdRZegFKVgenohR01jxUsRKB8FG6U1B8/+3N8egraSvOMnW8QAhgNiTK4OWbUY55T38PkI85LOq+z4F812p7avtBbuu1D+zg2OEIWO9QKP+rNNbUvvnOuQrkzLdsQc0BLqlQqQwpqEi7mLwrHeXyTrx0MsyGIVHZ+zPgvrBWrs5B43May6j37SZicTL/1JzzjsywU0Lj2Ej9YnVMicOhqh9heD3tIrxPPto0dMy6Hp6Bp6YvmXPA9/EVuQIILYIUbQ9ZEoAtLtP9ZbjOboHbDBIIsoVtFHRfp20dSnWy5/UcgWhNQj9Y3kAbF4mo6gvzjqE2Zj980d7Z/t/GPywvlJ0zqsR5y60erJLajf/Cx4Q+3c79ofIexe4GA0J4sDye2vPzSAtkPcJPsd7/GUdqqE7+M/BQIoPnteflZ9av4F+aM/jIqG9QPsEMCMd0IbzFOh/TZC06wjHcHq2zCMpveMuMlk2Y1mxQrobsD4u9UePV52SMFCPJNtaVtcGRugiGzvyZFJK69xlQYYwSzEZgoEzsf4nMAw7wHpvYQ+AiB48=
  - secure: yQXtz8BLBDmnLvmnHu8AlfH1la09UDJIlBWnHRZ1eYMw6iHrwVWG+1776lM2xBTERa7t8zdTc6o3MVWAFJFG1ewvX07S3XZy25QRGSOmBCbpwseb82BtEQX2kAY7DKlJpFwwJIsbL4nSV0Mso40j7A4CmqBX7ulFRnd3vWb0Mw2HrEPkxeMG2RWS6NaYJWw7J2nYLUQPLeeQ874wkxHrJBm1qzjqK+wEr6B71HpQBx9+dEDD/4aW48wzzTDo2yEdl6HAfneAKIIrffPMBT/CIvRyLjkLSTRi6fJfZ68lKjF9vs0Bwv43iIdgBjXIQXshe7sRlKr33j4wpCGutVY5HkJD01tFdrL2gB8pczq/mhUf5l9kFmseHJa5jQpwtnS7DYEK8MED3NJXj9QRwOEZo5wibv6U8ZA2aOP0jf/U460TX2w2YJwUCtXvY5OK9cFEB7/gE+LglKwZg6l3wGi7QR16x3hFlKAk7CoLvjbipZ5u7ACWXSxjpdt/HcoLTMO2Vs8lPRiMiGWWy0g1iozYeFcKGjw6BYOKTbinFBP3zKtff7/CfmzKploE9zcm9SgZ8A76BLRGXCWUTtsIpXDGMLJDHpNaI2P9oRCd5ZOfIwg5PB6C7rb4K25s0HCui1JhKL/5K+BhyMqdnyyqzZtETNy3zdtLEvX3suubT/YdRtk=
  - secure: FxEMGpAuM8fj4yWW8wTszRL12aWYnV8QxxnnC3vWjHNnVhKUf744Ekj7J5X9YsUj9+/g6mMV3TmIbMb5MXyVjMYIhKdFPI6g9AMA6uAO/1oYC2qxaYn6cXvpN0/ycdLVcVUDEJrHlCy0++mql9FhAvZleOr8isQZwFvR6eLuD0Obe6pmdZdWHM3Olv2ZHsBra4ElQ9FvhtxXQFrZaItMwGS/69BevoApf5U5NAz4JBStEdHUPzhKB8v6waoRooHKazTzo5UnO5WkNqT5qy15rt6ayW3JvPnKGxxHrgTK6tGJDCroFSgzXSYTKGyW/I1XIT4iZqJBywP5VsJ2e7bRtsG5aejVuNQIysD3cSjnWNh2jnfSAKqLdr+WfcKNwcVYpiPS6fj44c33XGCtmxz1l8Apf32xLxX63d/ylk7n/59CGpp1dO14/n7c2VKcZSgNU/0wem/sAJ6URGD84UOpD1g27NtlMf1RE2bziNQWRtDfeyGmsfPHbFhRufsh7h9pl9OZz4b0PlSUsbBtdvFQw4CuwV951DzTJfyxnSipXBxk9Y3px5vM93eHHw5h1/zfPn9siVku41d6Oa0TyyVsykl4bNurHw9DqVOe8y8PhhKN00FWIi5JIiqe9r+eYVxkXVoAvvo2w02fiG7XQ4rvJ2RZF20K+ou2A5vPKHZ/0Qw=
